<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>~/Dropbox/myfiles/sport_coding/online_contest/www.codechef.com/CodeChef_November_Challenge_2019_Division_1/From_Zero_to_Infinity/main.cpp.html</title>
<meta name="Generator" content="Vim/8.0">
<meta name="plugin-version" content="vim7.4_v2">
<meta name="syntax" content="cpp">
<meta name="settings" content="use_css,no_foldcolumn,expand_tabs,prevent_copy=">
<meta name="colorscheme" content="PaperColor">
<style type="text/css">
<!--
pre { font-family: monospace; color: #d0d0d0; background-color: #1c1c1c; }
body { font-family: monospace; color: #d0d0d0; background-color: #1c1c1c; }
* { font-size: 1em; }
.String { color: #d7af5f; }
.Number { color: #ff5faf; }
.Float { color: #ff5faf; }
.Function { color: #d0d0d0; }
.Structure { color: #00afaf; font-weight: bold; }
.cType { color: #afd700; font-weight: bold; }
.cStorageClass { color: #d7875f; font-weight: bold; }
.cFunction { color: #d0d0d0; }
.cppBoolean { color: #d7af00; font-weight: bold; }
.cppSTLnamespace { color: #af87d7; }
.Statement { color: #afd700; }
.Type { color: #afd700; font-weight: bold; }
.Include { color: #5faf5f; }
.cCharacter { color: #d7af5f; }
.parens { color: #ffffff; font-weight: bold; }
.cConditional { color: #af87d7; font-weight: bold; }
.cSpecial { color: #d7af5f; font-weight: bold; }
.cNumber { color: #ff5faf; }
.cRepeat { color: #af87d7; font-weight: bold; }
.cppStatement { color: #00afaf; }
.cppSTLconstant { color: #d0d0d0; }
.cppSTLtype { color: #d0d0d0; }
.cppSTLfunction { color: #d0d0d0; }
.cppSTLios { color: #d0d0d0; }
-->
</style>

<script type='text/javascript'>
<!--

-->
</script>
</head>
<body>
<pre id='vimCodeElement'>
<span class="Include">#include </span><span class="String">&lt;bits/stdc++.h&gt;</span>
<span class="cppStatement">using</span> <span class="Structure">namespace</span> <span class="cppSTLnamespace">std</span>;
<span class="cStorageClass">const</span> <span class="cType">int</span> MAX_P = <span class="Number">2101000</span>;
<span class="cppSTLtype">vector</span> &lt;<span class="cType">int</span>&gt; primes = <span class="parens">{</span><span class="Number">2</span><span class="parens">}</span>, powers;
<span class="cppSTLtype">vector</span> &lt;<span class="cppSTLtype">vector</span>&lt;<span class="cppSTLtype">pair</span>&lt;<span class="cType">int</span>,<span class="cType">int</span>&gt;&gt;&gt; prime_divisor;
<span class="cppSTLtype">map</span> &lt;<span class="cType">int</span>, <span class="cType">int</span>&gt; p_idx;
<span class="cppSTLtype">vector</span>&lt;<span class="cppSTLtype">pair</span>&lt;<span class="cType">int</span>,<span class="cType">int</span>&gt;&gt; factor;
<span class="cppSTLtype">vector</span> &lt;<span class="cppSTLtype">string</span>&gt; A, B;

<span class="cType">void</span> <span class="Function">sieve</span><span class="parens">(</span><span class="cType">int</span> n<span class="parens">)</span> <span class="parens">{</span>
  p_idx.<span class="Function">clear</span><span class="parens">()</span>;
  <span class="cppSTLtype">vector</span> &lt;<span class="Type">bool</span>&gt; <span class="Function">isPrime</span><span class="parens">(</span>MAX_P + <span class="Number">1</span>, <span class="cppBoolean">true</span><span class="parens">)</span>;
  <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> i = <span class="Number">3</span>; i*<span class="Number">2</span> &lt;= MAX_P; i += <span class="Number">2</span><span class="parens">)</span> <span class="parens">{</span>
    <span class="cType">int</span> p = <span class="cNumber">0</span>;
    <span class="cRepeat">while</span> <span class="parens">(</span><span class="Number">1ll</span> * i*<span class="parens">(</span>i + p<span class="parens">)</span> &lt;= MAX_P<span class="parens">)</span> isPrime<span class="parens">[</span>i*<span class="parens">(</span>i + p<span class="parens">)]</span> = <span class="cppBoolean">false</span>, ++p;
  <span class="parens">}</span>
  <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> i = <span class="Number">3</span>; i &lt;= MAX_P; i += <span class="Number">2</span><span class="parens">)</span> <span class="parens">{</span>
    <span class="cConditional">if</span> <span class="parens">(</span>isPrime<span class="parens">[</span>i<span class="parens">])</span> primes.<span class="Function">push_back</span><span class="parens">(</span>i<span class="parens">)</span>;
  <span class="parens">}</span>
  <span class="cType">int</span> idx = <span class="cNumber">0</span>;
  <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> p : primes<span class="parens">)</span> p_idx<span class="parens">[</span>p<span class="parens">]</span> = idx++;

  prime_divisor.<span class="Function">assign</span><span class="parens">(</span>n + <span class="Number">1</span>, <span class="cppSTLtype">vector</span>&lt;<span class="cppSTLtype">pair</span>&lt;<span class="cType">int</span>,<span class="cType">int</span>&gt;&gt;<span class="parens">())</span>;
  <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> i = <span class="Number">2</span>; i &lt;= n; ++i<span class="parens">)</span> <span class="parens">{</span>
    <span class="cType">int</span> i_ref = i;
    <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> p : primes<span class="parens">)</span> <span class="parens">{</span>
      <span class="cConditional">if</span> <span class="parens">(</span><span class="Number">1ll</span>*p*p &gt; <span class="Number">1ll</span>*i_ref<span class="parens">)</span> <span class="Statement">break</span>;
      <span class="cType">int</span> alp = <span class="cNumber">0</span>;
      <span class="cRepeat">while</span> <span class="parens">(</span>i_ref % p == <span class="cNumber">0</span><span class="parens">)</span> i_ref /= p, alp++;
      <span class="cConditional">if</span> <span class="parens">(</span>alp<span class="parens">)</span> prime_divisor<span class="parens">[</span>i<span class="parens">]</span>.<span class="Function">push_back</span><span class="parens">(</span><span class="cppSTLfunction">make_pair</span><span class="parens">(</span>p, alp<span class="parens">))</span>;
    <span class="parens">}</span>
    <span class="cConditional">if</span> <span class="parens">(</span>i_ref != <span class="Number">1</span><span class="parens">)</span> <span class="parens">{</span>
      prime_divisor<span class="parens">[</span>i<span class="parens">]</span>.<span class="Function">push_back</span><span class="parens">(</span><span class="cppSTLfunction">make_pair</span><span class="parens">(</span>i_ref, <span class="Number">1</span><span class="parens">))</span>;
    <span class="parens">}</span>
  <span class="parens">}</span>
<span class="parens">}</span>

<span class="cType">void</span> <span class="Function">calcA </span><span class="parens">()</span> <span class="parens">{</span>
  <span class="cType">int</span> k = <span class="parens">(</span><span class="cType">int</span><span class="parens">)</span>A.<span class="Function">size</span><span class="parens">()</span>;
  <span class="cppSTLtype">vector</span>&lt;<span class="cType">int</span>&gt; <span class="Function">xc</span><span class="parens">(</span><span class="Number">26</span><span class="parens">)</span>;
  <span class="cppSTLtype">vector</span>&lt;<span class="cType">int</span>&gt; <span class="Function">fxc</span><span class="parens">(</span><span class="Number">26</span><span class="parens">)</span>;
  <span class="cRepeat">for</span> <span class="parens">(</span><span class="cppSTLtype">string</span>&amp; s : A<span class="parens">)</span> <span class="parens">{</span>
    <span class="cppSTLtype">vector</span>&lt;<span class="Type">bool</span>&gt; <span class="Function">taken</span><span class="parens">(</span><span class="Number">26</span>, <span class="cppBoolean">false</span><span class="parens">)</span>;
    <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">char</span> &amp;ch : s<span class="parens">)</span> <span class="parens">{</span>
      <span class="cConditional">if</span> <span class="parens">(</span>!taken<span class="parens">[</span>ch-<span class="cCharacter">'a'</span><span class="parens">])</span>
        ++xc<span class="parens">[</span>ch - <span class="cCharacter">'a'</span><span class="parens">]</span>, taken<span class="parens">[</span>ch - <span class="cCharacter">'a'</span><span class="parens">]</span> = <span class="cppBoolean">true</span>;
      ++fxc<span class="parens">[</span>ch - <span class="cCharacter">'a'</span><span class="parens">]</span>;
    <span class="parens">}</span>
  <span class="parens">}</span>
  <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> al = <span class="cNumber">0</span>; al &lt; <span class="Number">26</span>; ++al<span class="parens">)</span> <span class="parens">{</span>
    <span class="cConditional">if</span> <span class="parens">(</span>xc<span class="parens">[</span>al<span class="parens">]</span> &gt; <span class="Number">1</span><span class="parens">)</span> <span class="parens">{</span>
      <span class="cRepeat">for</span> <span class="parens">(</span><span class="cppSTLtype">pair</span>&lt;<span class="cType">int</span>,<span class="cType">int</span>&gt; pr : prime_divisor<span class="parens">[</span>xc<span class="parens">[</span>al<span class="parens">]])</span> <span class="parens">{</span>
        <span class="cType">int</span> p = pr.<span class="Function">first</span>, alp = pr.<span class="Function">second</span>;
        factor<span class="parens">[</span>p_idx<span class="parens">[</span>p<span class="parens">]]</span>.<span class="Function">second</span> += alp;
      <span class="parens">}</span>

      <span class="cRepeat">for</span> <span class="parens">(</span><span class="cppSTLtype">pair</span>&lt;<span class="cType">int</span>,<span class="cType">int</span>&gt; pr : prime_divisor<span class="parens">[</span>fxc<span class="parens">[</span>al<span class="parens">]])</span> <span class="parens">{</span>
        <span class="cType">int</span> p = pr.<span class="Function">first</span>, alp = pr.<span class="Function">second</span>;
        factor<span class="parens">[</span>p_idx<span class="parens">[</span>p<span class="parens">]]</span>.<span class="Function">second</span> -=  k * alp;
      <span class="parens">}</span>
    <span class="parens">}</span>
  <span class="parens">}</span>
<span class="parens">}</span>

<span class="cType">void</span> <span class="Function">calcB </span><span class="parens">()</span> <span class="parens">{</span>
  <span class="cType">int</span> k = <span class="parens">(</span><span class="cType">int</span><span class="parens">)</span>B.<span class="Function">size</span><span class="parens">()</span>;
  <span class="cppSTLtype">vector</span>&lt;<span class="cType">int</span>&gt; <span class="Function">xc</span><span class="parens">(</span><span class="Number">26</span><span class="parens">)</span>;
  <span class="cppSTLtype">vector</span>&lt;<span class="cType">int</span>&gt; <span class="Function">fxc</span><span class="parens">(</span><span class="Number">26</span><span class="parens">)</span>;
  <span class="cRepeat">for</span> <span class="parens">(</span><span class="cppSTLtype">string</span>&amp; s : B<span class="parens">)</span> <span class="parens">{</span>
    <span class="cppSTLtype">vector</span>&lt;<span class="Type">bool</span>&gt; <span class="Function">taken</span><span class="parens">(</span><span class="Number">26</span>, <span class="cppBoolean">false</span><span class="parens">)</span>;
    <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">char</span> &amp;ch : s<span class="parens">)</span> <span class="parens">{</span>
      <span class="cConditional">if</span> <span class="parens">(</span>!taken<span class="parens">[</span>ch-<span class="cCharacter">'a'</span><span class="parens">])</span>
        ++xc<span class="parens">[</span>ch - <span class="cCharacter">'a'</span><span class="parens">]</span>, taken<span class="parens">[</span>ch - <span class="cCharacter">'a'</span><span class="parens">]</span> = <span class="cppBoolean">true</span>;
      ++fxc<span class="parens">[</span>ch - <span class="cCharacter">'a'</span><span class="parens">]</span>;
    <span class="parens">}</span>
  <span class="parens">}</span>
  <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> al = <span class="cNumber">0</span>; al &lt; <span class="Number">26</span>; ++al<span class="parens">)</span> <span class="parens">{</span>
    <span class="cConditional">if</span> <span class="parens">(</span>xc<span class="parens">[</span>al<span class="parens">]</span> &gt; <span class="Number">1</span><span class="parens">)</span> <span class="parens">{</span>
      <span class="cRepeat">for</span> <span class="parens">(</span><span class="cppSTLtype">pair</span>&lt;<span class="cType">int</span>,<span class="cType">int</span>&gt; pr : prime_divisor<span class="parens">[</span>xc<span class="parens">[</span>al<span class="parens">]])</span> <span class="parens">{</span>
        <span class="cType">int</span> p = pr.<span class="Function">first</span>, alp = pr.<span class="Function">second</span>;
        factor<span class="parens">[</span>p_idx<span class="parens">[</span>p<span class="parens">]]</span>.<span class="Function">second</span> -= alp;
      <span class="parens">}</span>

      <span class="cRepeat">for</span> <span class="parens">(</span><span class="cppSTLtype">pair</span>&lt;<span class="cType">int</span>,<span class="cType">int</span>&gt; pr : prime_divisor<span class="parens">[</span>fxc<span class="parens">[</span>al<span class="parens">]])</span> <span class="parens">{</span>
        <span class="cType">int</span> p = pr.<span class="Function">first</span>, alp = pr.<span class="Function">second</span>;
        factor<span class="parens">[</span>p_idx<span class="parens">[</span>p<span class="parens">]]</span>.<span class="Function">second</span> +=  k * alp;
      <span class="parens">}</span>
    <span class="parens">}</span>
  <span class="parens">}</span>
<span class="parens">}</span>

<span class="cType">int</span> v<span class="parens">[(</span><span class="cType">int</span><span class="parens">)</span><span class="Float">1e5</span> + <span class="Number">10</span><span class="parens">]</span>;

<span class="Type">bool</span> <span class="Function">check </span><span class="parens">(</span><span class="cppSTLtype">string</span> &amp;s<span class="parens">)</span> <span class="parens">{</span>
  <span class="cType">int</span> sz = <span class="parens">(</span><span class="cType">int</span><span class="parens">)</span>s.<span class="Function">size</span><span class="parens">()</span>;
  <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> i = <span class="cNumber">0</span>; i &lt; sz; ++i<span class="parens">)</span> <span class="parens">{</span>
    v<span class="parens">[</span>i<span class="parens">]</span> = <span class="parens">(</span>s<span class="parens">[</span>i<span class="parens">]</span> == <span class="cCharacter">'a'</span> || s<span class="parens">[</span>i<span class="parens">]</span> == <span class="cCharacter">'e'</span> || s<span class="parens">[</span>i<span class="parens">]</span> == <span class="cCharacter">'i'</span> || s<span class="parens">[</span>i<span class="parens">]</span> == <span class="cCharacter">'o'</span> || s<span class="parens">[</span>i<span class="parens">]</span> == <span class="cCharacter">'u'</span><span class="parens">)</span>;
  <span class="parens">}</span>

  <span class="cType">int</span> consonent = <span class="cNumber">0</span>, vowel = <span class="cNumber">0</span>;
  <span class="cConditional">if</span> <span class="parens">(</span>sz &lt;= <span class="Number">2</span><span class="parens">)</span> <span class="parens">{</span>
    <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> i = <span class="cNumber">0</span>; i &lt; sz; ++i<span class="parens">)</span> consonent += <span class="parens">(</span>v<span class="parens">[</span>i<span class="parens">]</span> == <span class="cNumber">0</span><span class="parens">)</span>, vowel += <span class="parens">(</span>v<span class="parens">[</span>i<span class="parens">]</span> == <span class="Number">1</span><span class="parens">)</span>;
    <span class="cConditional">if</span> <span class="parens">(</span>vowel &gt;= consonent<span class="parens">)</span> <span class="Statement">return</span> <span class="cppBoolean">true</span>;
  <span class="parens">}</span>
  <span class="cConditional">else</span> <span class="parens">{</span>
    <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> i = <span class="cNumber">0</span>; i + <span class="Number">3</span> - <span class="Number">1</span> &lt;= sz - <span class="Number">1</span>; ++i<span class="parens">)</span> <span class="parens">{</span>
      consonent = vowel = <span class="cNumber">0</span>;
      <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> j = i; j &lt; i + <span class="Number">3</span>; ++j<span class="parens">)</span> consonent += <span class="parens">(</span>v<span class="parens">[</span>j<span class="parens">]</span> == <span class="cNumber">0</span><span class="parens">)</span>, vowel += <span class="parens">(</span>v<span class="parens">[</span>j<span class="parens">]</span> == <span class="Number">1</span><span class="parens">)</span>;
      <span class="cConditional">if</span> <span class="parens">(</span>vowel &lt; consonent<span class="parens">)</span> <span class="Statement">return</span> <span class="cppBoolean">false</span>;
    <span class="parens">}</span>
  <span class="parens">}</span>
  <span class="Statement">return</span> <span class="cppBoolean">true</span>;
<span class="parens">}</span>

<span class="cType">int</span> <span class="cFunction">main</span><span class="parens">()</span> <span class="parens">{</span>
  <span class="cppSTLtype">ios_base</span>::<span class="cppSTLfunction">sync_with_stdio</span><span class="parens">(</span><span class="cppBoolean">false</span><span class="parens">)</span>; <span class="cppSTLconstant">cin</span>.<span class="Function">tie</span> <span class="parens">(</span><span class="cppSTLconstant">nullptr</span><span class="parens">)</span>;
  <span class="cppSTLconstant">cout</span>.<span class="Function">precision</span><span class="parens">(</span><span class="Number">7</span><span class="parens">)</span>;
  <span class="cppSTLconstant">cout</span> &lt;&lt; <span class="cppSTLios">fixed</span>;
  <span class="Function">sieve</span><span class="parens">((</span><span class="cType">int</span><span class="parens">)</span><span class="Float">1e5</span> + <span class="Number">10</span><span class="parens">)</span>;
  <span class="cType">int</span> tp = <span class="parens">(</span><span class="cType">int</span><span class="parens">)</span>primes.<span class="Function">size</span><span class="parens">()</span>;
  factor.<span class="Function">assign</span><span class="parens">(</span>tp + <span class="Number">1</span>, <span class="cppSTLtype">pair</span>&lt;<span class="cType">int</span>,<span class="cType">int</span>&gt;<span class="parens">(</span><span class="cNumber">0</span>, <span class="cNumber">0</span><span class="parens">))</span>;
  <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> i = <span class="cNumber">0</span>; i &lt; tp; ++i<span class="parens">)</span>
    factor<span class="parens">[</span>i<span class="parens">]</span>.<span class="Function">first</span> = primes<span class="parens">[</span>i<span class="parens">]</span>;

  <span class="cType">int</span> tc;
  <span class="cppSTLconstant">cin</span> &gt;&gt; tc;

  <span class="cRepeat">while</span> <span class="parens">(</span>tc--<span class="parens">)</span> <span class="parens">{</span>
    A.<span class="Function">clear</span><span class="parens">()</span>, B.<span class="Function">clear</span><span class="parens">()</span>;
    <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> i = <span class="cNumber">0</span>; i &lt;= tp; ++i<span class="parens">)</span>
      factor<span class="parens">[</span>i<span class="parens">]</span>.<span class="Function">second</span> = <span class="cNumber">0</span>;

    <span class="cType">int</span> l;
    <span class="cppSTLconstant">cin</span> &gt;&gt; l;
    <span class="cppSTLtype">string</span> s;
    <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> i = <span class="cNumber">0</span>; i &lt; l; ++i<span class="parens">)</span> <span class="parens">{</span>
      <span class="cppSTLconstant">cin</span> &gt;&gt; s;
      <span class="cConditional">if</span> <span class="parens">(</span><span class="Function">check</span><span class="parens">(</span>s<span class="parens">))</span> A.<span class="Function">push_back</span><span class="parens">(</span>s<span class="parens">)</span>;
      <span class="cConditional">else</span> B.<span class="Function">push_back</span><span class="parens">(</span>s<span class="parens">)</span>;
    <span class="parens">}</span>

    <span class="Function">calcA</span><span class="parens">()</span>;
    <span class="Function">calcB</span><span class="parens">()</span>;

    <span class="cType">long</span> <span class="cType">double</span> ans = <span class="Number">1</span>;
    <span class="cRepeat">for</span> <span class="parens">(</span><span class="cType">int</span> i = <span class="cNumber">0</span>; i &lt; tp; ++i<span class="parens">)</span> <span class="parens">{</span>
      <span class="cType">int</span> p = factor<span class="parens">[</span>i<span class="parens">]</span>.<span class="Function">first</span>, alp = factor<span class="parens">[</span>i<span class="parens">]</span>.<span class="Function">second</span>;
      <span class="cConditional">if</span> <span class="parens">(</span>alp<span class="parens">)</span> ans *= <span class="cppSTLfunction">pow</span> <span class="parens">(</span>p, alp<span class="parens">)</span>;
    <span class="parens">}</span>
    <span class="cppSTLconstant">cout</span> &lt;&lt; ans &lt;&lt; <span class="cSpecial">'\n'</span>;
  <span class="parens">}</span>

  <span class="Statement">return</span> <span class="cNumber">0</span>;
<span class="parens">}</span>
</pre>
</body>
</html>
<!-- vim: set foldmethod=manual : -->
